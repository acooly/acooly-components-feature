(function($){let adminClass={init:function(){this.initLogo();this.initMenus();this.initTab();this.initPlugins()},initLogo:function(){if($.acooly.system.config.logo){$(".logo-lg").html("<img src='"+$.acooly.system.config.logo+"' width='200'>")}else{if($.acooly.system.config.title){$(".logo-lg").text($.acooly.system.config.title)}else{$(".logo-lg").text("<b>Accoly</b> Sys V4.x")}}if($.acooly.system.config.shorttitle){$(".logo-mini").html($.acooly.system.config.shorttitle)}if($.acooly.system.config.logoMini){$("#logo_image").attr("src",$.acooly.system.config.logoMini)}if($.acooly.system.config.title){$("#logo_title").text($.acooly.system.config.title)}else{$("#logo_title").text("<b>Accoly</b> Sys V5.x")}$(".logo").show("normal")},initMenus:function(){$(document).on("click",".sidebar .nav .nav-link",function(e){$(".nav .nav-link").removeClass("active");$(this).addClass("active");var e=$(this).parent();while(e&&e.parent()&&e.attr("class").indexOf("nav-sidebar")==-1){e.parent().prev().addClass("active");e=e.parent()}})},initTab:function(){$("#layout_center_tabsMenu").menu({onClick:function(item){var curTabTitle=$(this).data("tabTitle");var type=$(item.target).attr("type");if(type==="refresh"){$("#layout_center_tabs").tabs("getTab",curTabTitle).panel("refresh");return}if(type==="close"){var t=$("#layout_center_tabs").tabs("getTab",curTabTitle);if(t.panel("options").closable){$("#layout_center_tabs").tabs("close",curTabTitle)}return}var allTabs=$("#layout_center_tabs").tabs("tabs");var closeTabsTitle=[];$.each(allTabs,function(){var opt=$(this).panel("options");if(opt.closable&&opt.title!=curTabTitle&&type==="closeOther"){closeTabsTitle.push(opt.title)}else if(opt.closable&&type==="closeAll"){closeTabsTitle.push(opt.title)}});for(var i=0;i<closeTabsTitle.length;i++){$("#layout_center_tabs").tabs("close",closeTabsTitle[i])}}});$("#layout_center_tabs").tabs({fit:true,height:$(window).height()-52,border:false,pill:true,onContextMenu:function(e,title){e.preventDefault();$("#layout_center_tabsMenu").menu("show",{left:e.pageX,top:e.pageY}).data("tabTitle",title)},tools:[{text:'<i class="fa fa-refresh"></i>',handler:function(){var href=$("#layout_center_tabs").tabs("getSelected").panel("options").href;if(href){var index=$("#layout_center_tabs").tabs("getTabIndex",$("#layout_center_tabs").tabs("getSelected"));$("#layout_center_tabs").tabs("getTab",index).panel("refresh")}else{var panel=$("#layout_center_tabs").tabs("getSelected").panel("panel");var frame=panel.find("iframe");try{if(frame.length>0){for(var i=0;i<frame.length;i++){frame[i].src=frame[i].src}if($.browser.msie){CollectGarbage()}}}catch(e){}}}},{text:'<i class="fa fa-close"></i>',handler:function(){var index=$("#layout_center_tabs").tabs("getTabIndex",$("#layout_center_tabs").tabs("getSelected"));if(index<=0){return}var tab=$("#layout_center_tabs").tabs("getTab",index);if(tab.panel("options").closable){$("#layout_center_tabs").tabs("close",index)}else{$.messager.alert("提示","["+tab.panel("options").title+"]不可以被关闭","error")}}}]})},initPlugins:function(){},headerToggle:function(){var header=$(".main-header");if(header.is(":hidden")){header.show();$(".main-sidebar").css("padding-top","50px");$(".user-panel").hide();$("#menu-toggle-icon").removeClass("fa-compress");$("#menu-toggle-icon").addClass("fa-expand")}else{header.hide();$(".main-sidebar").css("padding-top","0");$(".user-panel").show();$("#menu-toggle-icon").removeClass("fa-expand");$("#menu-toggle-icon").addClass("fa-compress")}}};let tabClass={MAIN_TABS_ID:"layout_center_tabs",getTabs:function(){return $("#"+this.MAIN_TABS_ID)},add:function(opts){var options=$.extend({closable:true,iconCls:"fa fa-circle-o",loadMode:1},opts);var t=this.getTabs();if(t.tabs("exists",options.title)){t.tabs("select",options.title)}else{if(options.loadMode==1){options.href=contextPath+options.url}else{options.content='<iframe src="'+options.url+'" frameborder="0" style="border:0;width:100%;height:99%;"></iframe>'}var That=this;$.extend(options,{onLoadError:function(e,x,y){That.close();$.acooly.toast("错误","请求的功能不存在")}});t.tabs("add",options)}},addPage:function(title,iconCls,url){this.add({title:title,iconCls:iconCls,loadMode:1,url:url})},addIframe:function(title,iconCls,url){this.add({title:title,iconCls:iconCls,loadMode:2,url:url})},select:function(title){this.getTabs().tabs("select",title)},getSelect:function(){return this.getTabs().tabs("getSelected").panel("options")},refresh:function(title){this.getTabs().tabs("getTab",title).panel("refresh")},close:function(){var t=this.getTabs();var index=t.tabs("getTabIndex",t.tabs("getSelected"));if(index<=0){return}var tab=t.tabs("getTab",index);if(tab.panel("options").closable){t.tabs("close",index)}else{$.messager.alert("提示","["+tab.panel("options").title+"]不可以被关闭","error")}}};let themeClass={defaultExpires:7,acoolyThemeKey:"acoolyTheme",loadTheme:function(){var themeName=$.acooly.admin.theme.getTheme($.acooly.admin.theme.acoolyThemeKey);if(!themeName){themeName="acooly"}if(themeName=="easyui"){themeName="default"}this.changeThemeStyle(themeName)},changeTheme:function(themeName){if(themeName){$.acooly.admin.theme.saveTheme($.acooly.admin.theme.acoolyThemeKey,themeName)}else{themeName=$.acooly.admin.theme.getTheme($.acooly.admin.theme.acoolyThemeKey)}if(themeName=="easyui"){themeName="default"}this.changeThemeStyle(themeName)},changeThemeStyle:function(themeName){var $easyuiTheme=$("#easyuiTheme");var url=$easyuiTheme.attr("href");var href=url.substring(0,url.indexOf("themes"))+"themes/"+themeName+"/easyui.css";$easyuiTheme.attr("href",href);var $easyuiThemeBasic=$("#easyuiThemeBasic");var urlBasic=$easyuiThemeBasic.attr("href");var hrefBasic=url.substring(0,urlBasic.indexOf("themes"))+"themes/"+themeName+"/basic.css";$easyuiThemeBasic.attr("href",hrefBasic)},getTheme:function(key){if(!key){key=this.acoolyThemeKey}return $.cookie(key)},saveTheme:function(key,value){var args=arguments;var ckey=args.length==1?this.acoolyThemeKey:key;if(!ckey){ckey=this.acoolyThemeKey}var domain=this.getMainHost();$.cookie(ckey,value,{expires:this.defaultExpires,domain:domain})},getMainHost:function(){let key=`mh_${Math.random()}`;let keyR=new RegExp(`(^|;)\\s*${key}=12345`);let expiredTime=new Date(0);let domain=document.domain;let domainList=domain.split(".");let urlItems=[];urlItems.unshift(domainList.pop());while(domainList.length){urlItems.unshift(domainList.pop());let mainHost=urlItems.join(".");let cookie=`${key}=${12345};domain=.${mainHost}`;document.cookie=cookie;if(keyR.test(document.cookie)){document.cookie=`${cookie};expires=${expiredTime}`;return mainHost}}}};if(!$.acooly){$.acooly={}}$.extend($.acooly,{admin:adminClass});$.extend($.acooly.admin,{theme:themeClass});$.extend($.acooly.admin,{tab:tabClass})})(jQuery);$.extend($.fn.validatebox.defaults.rules,{byteLength:{validator:function(value,param){let minlen=param[0];let maxlen=param[1];return $.acooly.verify.byteLength(value,minlen,maxlen)},message:"输入的数据长度超出范围."},fixedLength:{validator:function(value,param){let fixedLength=param[0];return $.acooly.verify.byteLength(value,fixedLength,fixedLength)},message:"输入的数据长度只能为{0}."},number:{validator:function(value,param){var min=param&&param[0]?param[0]:0;var max=param&&param[1]?param[1]:999999999;return $.acooly.verify.number(value)&&value>=min&&value<=max},message:"输入的数字超出范围."},integer:{validator:function(value,param){var min=param&&param[0]?param[0]:0;var max=param&&param[1]?param[1]:999999999;return $.acooly.verify.number(value)&&value>=min&&value<=max},message:"输入的数字超出范围."},decimal:{validator:function(value,param){var min=param&&param[0]?param[0]:0;var max=param&&param[1]?param[1]:999999999;return $.acooly.verify.decimal(value)&&value>=min&&value<=max},message:"输入的数字超出范围."},equals:{validator:function(value,param){return value==$(param[0]).val()},message:"两次输入不相同."},notEquals:{validator:function(value,param){return value!=$(param[0]).val()},message:"两次输入不能相同."},CHS:{validator:function(value){return $.acooly.verify.chs(value)},message:"只能输入汉字"},chinese:{validator:function(value){return $.acooly.verify.chs(value)},message:"只能输入汉字"},mobile:{validator:function(value){return $.acooly.verify.mobile(value)},message:"输入手机号码格式不准确."},zipcode:{validator:function(value){let reg=/^[1-9]\d{5}$/;return reg.test(value)},message:"邮编必须是非0开始的6位数字."},account:{validator:function(value,param){if(!$.acooly.verify.account(value)){$.fn.validatebox.defaults.rules.account.message="用户名只能字母开头，数字、字母、下划线组成.";return false}else{return true}},message:"用户名只能字母开头，数字、字母、下划线组成."},memberNo:{validator:function(value,param){if(!$.acooly.verify.member(value)){return false}return true},message:"编码只能由字母和数字组成."},commonRegExp:{validator:function(value,param){let re=new RegExp(param[0]);return $.acooly.verify.regExp(value,re)},message:"{1}"},regExp:{validator:function(value,param){return $.acooly.verify.regExp(value,param[0])},message:"{1}"},validImg:{validator:function(value,param){let param1=param[0];let param1List=param1.split(",");let extname=value.substring(value.lastIndexOf(".")+1,value.length);extname=extname.toLowerCase();for(let i=0;i<param1List.length;i++){if(param1List[i]==extname){return true}}},message:"{1}"},simplecsv:{validator:function(value,param){return $.acooly.verify.csv(value)},message:"多个用户和组使用逗号分割"},money:{validator:function(value,param){return $.acooly.verify.money(value)},message:"金额必须为整数或最多两位小数"},percent:{validator:function(value,param){return $.acooly.verify.decimal(value)&&value>=0&&value<=100},message:"百分数必须在0-100间"},bankcard:{validator:function(value,param){return $.acooly.verify.number(value)},message:"银行卡号必须为数字组成"},cert:{validator:function(value,param){return $.acooly.verify.cert(value)},message:"18位有效身份证号码"},idcard:{validator:function(value,param){return $.acooly.verify.cert(value)},message:"18位有效身份证号码"},json:{validator:function(value){return $.acooly.verify.json(value)},message:"JSON格式验证未通过"},roleName:{validator:function(value){const regex=/^ROLE_[A-Z,_]+$/;return regex.test(value)},message:"角色名称必须以ROLE_开头的大写英文字母组成"}});var idFormatter=function(value,row){return row.id};var moneyFormatter=function(value){return $.acooly.format.money(value,true)};var centMoneyFormatter=function(value){return $.acooly.format.money(value,false)};var fileSizeFormatter=function(value){return $.acooly.format.fileSize(value)};var fileFormatter=function(value,row,index,data){if(!value||value=="")return null;let fileMeta=$.acooly.file.parse(value);let url=value;if(data&&data.data&&data.data.serverRoot){url=data.data.serverRoot+value}let html="<a href='javascript:;' onclick=\"$.acooly.file.play('"+url+"')\"><i class='fa "+fileMeta.icon+" fa-fw fa-col'></i> "+fileMeta.name+"</a>";return html};var dateFormatter=function(datetime){return $.acooly.format.date(datetime,"yyyy-MM-dd")};var dateTimeFormatter=function(datetime){return $.acooly.format.date(datetime,"yyyy-MM-dd HH:mm:ss")};var timeFormatter=function(datetime){return $.acooly.format.date(datetime,"HH:mm:ss")};var secondFormatter=function(seconds){return $.acooly.format.timespan(seconds)};var millisecondFormatter=function(millisecond){return $.acooly.format.timespan(millisecond,"ms")};var contentFormatter=function(value){return $.acooly.format.content(value)};var linkFormatter=function(value){return $.acooly.format.link(value)};var jsonFormatter=function(value){return $.acooly.format.json(value)};var percentFormatter=function(value){if(!value)return value;return value+"%"};var centPercentFormatter=function(value){return $.acooly.format.money(value,false)+"%"};var mappingFormatter=function(value,row,index,data,field){try{var mapping="all"+field.substring(0,1).toUpperCase()+field.substring(1,field.length)+"s";return data["data"][mapping][value]}catch(e){return value}};var actionFormatter=function(value,row,index,data,field){return formatString($("#"+actionContainer).html(),row.id)};var formatFileSize=function(value){return $.acooly.format.fileSize(value)};var formatCurrency=function(value){return $.acooly.format.money(value)};var formatDate=function(datetime){return $.acooly.format.date(datetime,"yyyy-MM-dd")};var formatTime=function(seconds){return $.acooly.format.timespan(seconds)};var formatContent=function(value,maxSize){return $.acooly.format.content(value,maxSize)};var formatLink=function(value,label){return $.acooly.format.link(value,label)};var formatPercent=function(value,label){return value+"%"};var formatString=function(str){for(var i=0;i<arguments.length-1;i++){eval("var re = /\\{"+i+"\\}/g;");str=str.replace(re,arguments[i+1])}return str};var formatIcon=function(value){return"<span style='vertical-align:middle;display:inline-block; width:16px; height:16px;' class='"+value+"'></span>"};var formatRefrence=function(datagrid,filed,value){try{return $("#"+datagrid).datagrid("getData")["data"][filed][value]}catch(e){return value}};var formatAction=function(actionContainer,value,row){if(row.showCheckboxWithId==""){return""}return formatString($("#"+actionContainer).html(),row.id)};stringToList=function(value){if(value!=undefined&&value!=""){var values=[];var t=value.split(",");for(var i=0;i<t.length;i++){values.push(""+t[i])}return values}else{return[]}};function mapToOptions(map,forSearch){var mapJson="[";if(forSearch){mapJson+="{id:'',text:'所有'}"}var i=0;for(var key in map){if(i==0&&!forSearch){mapJson+="{id:"+key+","+"text:'"+map[key]+"'}"}else{mapJson+=",{id:"+key+","+"text:'"+map[key]+"'}"}i++}mapJson+="]";return eval(mapJson)}$.fn.panel.defaults.loadingMessage="加载中....";$.fn.datagrid.defaults.loadMsg="加载中....";$.fn.panel.defaults.onBeforeDestroy=function(){var frame=$("iframe",this);try{if(frame.length>0){for(var i=0;i<frame.length;i++){frame[i].contentWindow.document.write("");frame[i].contentWindow.close()}frame.remove();if($.browser.msie){CollectGarbage()}}}catch(e){}};$.fn.datagrid.defaults.loadFilter=function(data,parent){if(!data.success&&data.message){$.messager.alert("提示",data.message);return null}return data};var commonErrorFunction=function(XMLHttpRequest,e,x){$.messager.progress("close");var message;switch(XMLHttpRequest.status){case 500:message="服务器系统内部错误";break;case 401:message="未认证";break;case 403:message="无权限执行此操作";break;case 404:message="请求页面不存在";break;case 408:message="请求超时";break;default:message=XMLHttpRequest.responseText}if(message&&message!=""){$.messager.alert("错误",message,"warning")}};$.fn.datagrid.defaults.onLoadError=commonErrorFunction;$.fn.treegrid.defaults.onLoadError=commonErrorFunction;$.fn.tree.defaults.onLoadError=commonErrorFunction;$.fn.combogrid.defaults.onLoadError=commonErrorFunction;$.fn.combobox.defaults.onLoadError=commonErrorFunction;$.fn.form.defaults.onLoadError=commonErrorFunction;$.ajaxSetup({type:"POST"});var easyuiPanelOnMove=function(left,top){var l=left;var t=top;if(l<1){l=1}if(t<1){t=1}var width=parseInt($(this).parent().css("width"))+14;var height=parseInt($(this).parent().css("height"))+14;var right=l+width;var buttom=t+height;var browserWidth=$(window).width();var browserHeight=$(window).height();if(right>browserWidth){l=browserWidth-width}if(buttom>browserHeight){t=browserHeight-height}$(this).parent().css({left:l,top:t})};$.fn.dialog.defaults.onMove=easyuiPanelOnMove;$.fn.window.defaults.onMove=easyuiPanelOnMove;$.fn.panel.defaults.onMove=easyuiPanelOnMove;serializeObject=function(form){var o={};$.each(form.serializeArray(),function(index){if(o[this["name"]]){o[this["name"]]=o[this["name"]]+","+this["value"]}else{o[this["name"]]=this["value"]}});return o};serializeObjectFromContainer=function(container){var queryParams={};$("input[name^='search']",container).each(function(){if(queryParams[this["name"]]){queryParams[this["name"]]=queryParams[this["name"]]+","+this["value"]}else{queryParams[this["name"]]=this["value"]}});return queryParams};isEmptyObject=function(obj){for(var name in obj){return false}return true};let acooly_editor={kindEditor:function(opts){if(!KindEditor){console.log("KindEditor为加载，请配置加载插件。");return}let uploadUrl=opts.uploadUrl;if(!uploadUrl){let token=$("meta[name='X-CSRF-TOKEN']").attr("content");uploadUrl="/ofile/kindEditor.htm?_csrf="+token}opts.uploadUrl=uploadUrl;let options={minHeight:opts.minHeight+"px",resizeType:1,allowFileManager:true,allowMediaUpload:true,allowFlashUpload:true,items:["fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","removeformat","lineheight","|","justifyleft","justifycenter","justifyright","anchor","plainpaste","wordpaste","clearhtml","quickformat","insertorderedlist","insertunorderedlist","|","emoticons","image","multi_image","diy_video","|","baidumap","link","unlink","|","hr","table","|","source","preview","mobile","fullscreen"],uploadJson:uploadUrl,uploadApi:uploadUrl,afterCreate:function(){var color=$(".panel-header").css("background-color");$(".ke-toolbar").css("background-color",color);$.acooly.editor.pasteToUpload(this,opts)},afterBlur:function(){this.sync()}};KindEditor.options.filterMode=false;return KindEditor.create("#"+opts.textareaId,options)},pasteToUpload:function(editorObj,opts){var doc=editorObj.edit.doc;$(doc.body).bind("paste",function(event){setTimeout(function(){var useless=$(doc.body).find(".__kindeditor_paste__");if(useless){useless.removeAttr("style");useless.removeClass("__kindeditor_paste__")}var imgs=$(doc.body).find("img");$.each(imgs,function(index,item){layerindex=layer.load(1,{shade:[.3,"#fff"],content:"转存中",success:function(layero){layero.find(".layui-layer-content").css({"padding-top":"39px",width:"120px","margin-left":"-60px"})}});var _that=$(this);var imgSrc=decodeURIComponent(_that.attr("src"));if(imgSrc.indexOf("data:")>-1){var blob=$.acooly.editor.dataURLtoBlob(imgSrc);var form=document.imgForm;var formData=new FormData(form);formData.append("file",blob);$.ajax({type:"POST",url:opts.uploadUrl,data:formData,dataType:"json",processData:false,contentType:false,success:function(res){layer.close(layerindex);if(res.success){_that.attr("src",res.url);_that.attr("data-ke-src",res.url)}},fail:function(){layer.close(layerindex)}})}else{layer.close(layerindex)}})},10)})},dataURLtoBlob:function(dataurl){var arr=dataurl.split(","),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n)}return new Blob([u8arr],{type:mime})}};(function($){if(!$.acooly){$.acooly={}}if(!$.acooly.editor){$.extend($.acooly,{editor:acooly_editor})}})(jQuery);let acooly_file={play:function(resourceUrl,opts){if(!resourceUrl||resourceUrl=="")return;if(this.SERVER_ROOT!=""){if(!resourceUrl.startsWith(this.SERVER_ROOT)){resourceUrl=this.SERVER_ROOT+resourceUrl}}let data=this.parse(resourceUrl);if(data.type==this.fileType.image){this.playImage(resourceUrl,opts)}else if(data.type==this.fileType.pdf){this.playPdf(resourceUrl,opts)}else if(data.type==this.fileType.media){this.playMedia(resourceUrl,opts)}else{this.download(resourceUrl,opts)}},download:function(resourceUrl){window.open(resourceUrl)},playMedia:function(resourceUrl,opts){let data=this.parse(resourceUrl);let defOpts={width:650,height:530,maximizable:false,modal:true,title:" <i class='fa "+data.icon+"' aria-hidden='true'></i> "+data.name,onClose:function(){$(this).dialog("destroy")}};let config=$.extend(defOpts,opts);let w=config.width-10,h=config.height-50;config.content="<video class='video-js vjs-big-play-centered' playsinline controls preload='auto' width='"+w+"' height='"+h+"'\n"+"               data-setup='{}' language=\"zh\"\n"+"    <source src='"+resourceUrl+"' type='video/mp4'>\n"+"    <p class='vjs-no-js'>\n"+"        To view this video please enable JavaScript, and consider upgrading to a web browser that\n"+"        <a href='https://videojs.com/html5-video-support/' target='_blank'>supports HTML5 video</a>\n"+"    </p>\n"+"</video>";$("<div/>").dialog(config)},playPdf:function(resourceUrl,opts){let data=this.parse(resourceUrl);let defOpts={width:1024,height:768,maximizable:true,modal:true,title:" <i class='fa "+data.icon+"' aria-hidden='true'></i> "+data.name,content:"<a class='media' href='"+resourceUrl+"'></a>",onClose:function(){$(this).dialog("destroy")},onOpen:function(){let options=$(this).dialog("options");$(".media").media({width:options.width-10,height:options.height})}};let config=$.extend(defOpts,opts);$("<div/>").dialog(config)},playImage:function(resourceUrl,opts){let data=this.parse(resourceUrl);let defOpts={maximizable:false,modal:true,title:" <i class='fa "+data.icon+"' aria-hidden='true'></i> "+data.name,onClose:function(){$(this).dialog("destroy")}};let options=$.extend(defOpts,opts);if(!options.width){options.width=(document.documentElement.clientWidth||document.body.clientWidth)-100}if(!options.height){options.height=(document.documentElement.clientHeight||document.body.clientHeight)-100}let realWidth,realHeight;$("<img/>").attr("src",resourceUrl).load(function(){realWidth=this.width;realHeight=this.height;let maxWidth=options.width,maxHeight=options.height;let width=realWidth,height=realHeight;if(realWidth>maxWidth){width=maxWidth;height=width*realHeight/realWidth}realHeight=height;if(height>maxHeight){height=maxHeight;width=height*width/realHeight}options.width=width+20;options.height=height+55;options.width=options.width<300?300:options.width;options.height=options.height<200?200:options.height;options.content="<div style='text-align: center;'><a href='"+resourceUrl+"' target='_blank'>"+"<img style='width: "+width+"px;height: "+height+"px' src='"+resourceUrl+"'></a></div>";$("<div/>").dialog(options)})},parse:function(resourceUrl){let data={};if(resourceUrl.indexOf(".")==-1){data.type=this.fileType.other}else{let fileExtension=resourceUrl.split(".").pop().toLowerCase();let fileType,fileIcon;if(this.fileType.image.ext.indexOf(fileExtension)!=-1){fileType=this.fileType.image;fileIcon=this.fileType.image.icon}else if(this.fileType.pdf.ext.indexOf(fileExtension)!=-1){fileType=this.fileType.pdf;fileIcon=this.fileType.pdf.icon}else if(this.fileType.media.ext.indexOf(fileExtension)!=-1){fileType=this.fileType.media;fileIcon=this.fileType.media.icon}else if(this.fileType.office.ext.indexOf(fileExtension)!=-1){fileType=this.fileType.office;fileIcon=this.fileType.office.getIcon(fileExtension)}else if(this.fileType.archive.ext.indexOf(fileExtension)!=-1){fileType=this.fileType.archive;fileIcon=this.fileType.archive.icon}else{fileType=this.fileType.other;fileIcon=this.fileType.other.icon}data.type=fileType;data.icon=fileIcon}if(resourceUrl.indexOf("/")==-1){data.name=resourceUrl}else{data.name=resourceUrl.split("/").pop()}if(data.name){data.name=decodeURI(data.name)}return data},fileType:{image:{name:"图片",ext:"jpg,jpeg,png,gif,bmp",icon:"fa-picture-o"},pdf:{name:"PDF",ext:"pdf",icon:"fa-file-pdf-o"},media:{name:"媒体",ext:"aif,aiff,aac,au,bmp,gsm,mov,mid,midi,mpg,mpeg,mp4,m4a,psd,qt,qtif,qif,qti,snd,tif,tiff,wav,3g2,3pg,flv, mp3, swf,asx, asf, avi, wma, wmv,ra, ram, rm, rpm, rv, smi, smil,xaml",icon:"fa-file-video-o"},archive:{name:"归档",ext:"zip,rar,iso",icon:"fa-file-archive-o"},office:{name:"文档",ext:"doc,docx,xls,xlsx,rtf,ppt,pptx",icon:"fa-file-o",getIcon:function(ext){if(!ext||ext=="")return this.icon;if(ext.startsWith("doc")||ext=="rtf"){return"fa-file-word-o"}else if(ext.startsWith("xls")){return"fa-file-excel-o"}else if(ext.startsWith("ppt")){return"fa-file-powerpoint-o"}else{return this.icon}}},other:{name:"其他",ext:"",icon:"fa-file-o"}},SERVER_ROOT:""};(function($){if(!$.acooly){$.acooly={}}if(!$.acooly.file){$.extend($.acooly,{file:acooly_file})}})(jQuery);(function($){var formatClass={fileSize:function(value){if(!value||value=="")return"";if(value<1024){return value+"byte"}else if(value>=1024&&value<1024*1024){return Math.round(value/1024*100)/100+"K"}else if(value>=1024*1024&&value<1024*1024*1024){return Math.round(value/1024/1024*100)/100+"M"}else{return Math.round(value/1024/1024/1024*100)/100+"G"}},money:function(num,yuan,symbol){if(!num||num=="")return"0.00";num=num.toString().replace(/\$|\,/g,"");if(isNaN(num))num="0";if(!yuan)num=num/100;if(!symbol)symbol="";sign=num==(num=Math.abs(num));num=Math.floor(num*100+.50000000001);cents=num%100;num=Math.floor(num/100).toString();if(cents<10)cents="0"+cents;for(var i=0;i<Math.floor((num.length-(1+i))/3);i++)num=num.substring(0,num.length-(4*i+3))+","+num.substring(num.length-(4*i+3));currency=(sign?"":"-")+num+"."+cents;return symbol+currency},date:function(d,format){if(!d||d=="")return"";if(!format){format="yyyy-MM-dd HH:mm:ss"}if(typeof d=="string"){d=d.replace(/-/g,"/");d=new Date(d)}return this._dateFormat(d,format)},timespan:function(span,unit){if(!unit||unit=="s"){span=span*1e3}var sm=Math.floor(span%1e3);var second=Math.floor(span/1e3%60);var minite=Math.floor(span/1e3/60%60);var hour=Math.floor(span/1e3/3600%24);var hourspan=(hour<10?"0"+hour:hour)+":"+(minite<10?"0"+minite:minite)+":"+(second<10?"0"+second:second);var day=Math.floor(span/1e3/3600/24%356);day=day>0?day+"天":"";sm=sm>0?"."+sm:"";return day+hourspan+sm},content:function(html,maxSize){if(!html||html=="")return"";if(!maxSize)maxSize=18;if(html.length>maxSize){temp=html.substring(0,maxSize);html='<a style="cursor: pointer;" title="'+html+'" >'+'<span style="white-space: normal;">'+temp+'...<i class="fa fa-angle-double-down fa-col fa-lg text-primary" aria-hidden="true"'+' onclick="$(this).parent().parent().children().toggle()"></i></span>'+'<span style="white-space: normal;display:none;">'+html+'&nbsp;<i class="fa fa-angle-double-up fa-col fa-lg text-primary" aria-hidden="true" onclick="$(this).parent().parent().children().toggle()"></i></span></a>'}return html},link:function(url,label){if(!url||url=="")return"";if(!label)label="查看";let html='<a href="'+url+'" title="'+url+'" target="_blank">'+label+"</a>";return html},template:function(str){for(var i=0;i<arguments.length-1;i++){eval("var re = /\\{"+i+"\\}/g;");str=str.replace(re,arguments[i+1])}return str},json:function(json,options){if(!json||json=="")return"";var reg=null,keyStyle="color:#92278f;",valStyle="color:#3ab54a;",formatted="",pad=0,PADDING="    ";options=options||{};options.newlineAfterColonIfBeforeBraceOrBracket=options.newlineAfterColonIfBeforeBraceOrBracket===true?true:false;options.spaceAfterColon=options.spaceAfterColon===false?false:true;try{if(typeof json!=="string"){json=JSON.stringify(json)}else{reg=/:\,/g;json=json.replace(reg,':"",');reg=/:(\s)\}/g;json=json.replace(reg,':""}');reg=/:(\s)\]/g;json=json.replace(reg,':""]');json=JSON.parse(json);json=JSON.stringify(json)}}catch(e){return json}reg=/\r\n\,/g;json=json.replace(reg,",");reg=/([\{\}])/g;json=json.replace(reg,"\r\n$1\r\n");reg=/([\[\]])/g;json=json.replace(reg,"\r\n$1\r\n");reg=/(\"\,)/g;json=json.replace(reg,"$1\r\n");if(!options.newlineAfterColonIfBeforeBraceOrBracket){reg=/\:\r\n\{/g;json=json.replace(reg,":{");reg=/\:\r\n\[/g;json=json.replace(reg,":[")}if(options.spaceAfterColon){reg=/\:/g;json=json.replace(reg,": ")}$.each(json.split("\r\n"),function(index,node){var i=0,indent=0,padding="";if(node.match(/\{$/)||node.match(/\[$/)){indent=1}else if(node.match(/\}/)||node.match(/\]/)){if(pad!==0){pad-=1}}else{if(node&&node!=""){var pair=node.split(":");if(pair[1]){node='<span style="'+keyStyle+'">'+pair[0]+'</span>:<span style="'+valStyle+'">'+pair[1]+"</span>"}else{node='<span style="'+valStyle+'">'+pair[0]+"</span>"}}indent=0}for(i=0;i<pad;i++){padding+=PADDING}formatted+=padding+node+"\r\n";pad+=indent});return formatted},mask:function(value){},_dateFormat:function(dateObject,format){var o={"M+":dateObject.getMonth()+1,"d+":dateObject.getDate(),"H+":dateObject.getHours(),"m+":dateObject.getMinutes(),"s+":dateObject.getSeconds(),"q+":Math.floor((dateObject.getMonth()+3)/3),S:dateObject.getMilliseconds()};if(/(y+)/.test(format))format=format.replace(RegExp.$1,(dateObject.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o)if(new RegExp("("+k+")").test(format))format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));return format}};$.extend($.acooly,{format:formatClass})})(jQuery);(function($){if(!$.acooly){$.acooly={}}$.extend($.acooly,{acooly:{selectedMenu:null,westTree:null,divdialog:null}});$.extend($.acooly,{framework:{afterQueryParams:{},create:function(opts){if(opts.entity){$.acooly.framework.doCreate(opts.url,"manage_"+opts.entity+"_editform","manage_"+opts.entity+"_datagrid",opts.title,opts.top,opts.width,opts.height,opts.addButton,opts.reload,opts.maximizable,opts.onSubmit,opts.onSuccess,opts.onFail||opts.onFailure,opts.onCloseWindow||opts.onClose,opts.ajaxData,opts.buttons,opts.hideSaveBtn)}else{$.acooly.framework.doCreate(opts.url,opts.form,opts.datagrid,opts.title,opts.top,opts.width,opts.height,opts.addButton,opts.reload,opts.maximizable,opts.onSubmit,opts.onSuccess,opts.onFail||opts.onFailure,opts.onCloseWindow||opts.onClose,opts.ajaxData,opts.buttons,opts.hideSaveBtn)}},ajaxSubmitHandler:function(type,thisObject,form,datagrid,reload,onSubmit,onSuccess,onFailure){var d=$(thisObject).closest(".window-body");$("#"+form).ajaxSubmit({beforeSerialize:function(formData,options){try{var _beforeSubmit=eval(form+"_beforeSubmit");if(typeof _beforeSubmit=="function"){_beforeSubmit.call(this,formData)}}catch(e){}},beforeSubmit:function(formData,jqForm,options){if(onSubmit&&!onSubmit.call(this,arguments)){return false}try{var defaultFunc=eval(form+"_onSubmit");if(defaultFunc&&typeof defaultFunc=="function"&&!defaultFunc.call(this,arguments)){return false}}catch(e){}var result=$("#"+form).form("validate");$(thisObject).linkbutton(result?"disable":"enable");return result},success:function(result,statusText){$(thisObject).linkbutton("enable");if(typeof result=="string"){result=eval("("+result+")")}try{if(result.success){if(onSuccess){onSuccess.call(d,result)}if(type=="create"){$.acooly.framework.onSaveSuccess(d,datagrid,result,reload)}else{$.acooly.framework.onUpdateSuccess(d,datagrid,result,reload)}$.acooly.divdialog.dialog("destroy")}else{if(onFailure){onFailure.call(d,result)}}if(result.message){$.acooly.messager("提示",result.message,result.success?"success":"danger")}}catch(e){$.acooly.messager("错误",e,"danger")}},error:function(XmlHttpRequest,textStatus,errorThrown){$(thisObject).linkbutton("enable");$.acooly.messager("错误",errorThrown,"danger")}})},doCreate:function(url,form,datagrid,title,top,width,height,addButton,reload,maximizable,onSubmit,onSuccess,onFailure,onClose,ajaxData,buttons,hideSaveBtn){$("#"+datagrid).datagrid("uncheckAll").datagrid("unselectAll").datagrid("clearSelections");var t=top?top:null;var w=width?width:500;var h=height?height:"auto";var tt=title?title:"添加";tt='<i class="fa fa-lg fa-fw fa-col fa-floppy-o" ></i>'+tt;var addB=addButton?addButton:"增加";addB='<i class="fa fa-lg fa-fw fa-col fa-plus-circle" ></i>'+addB;var max=maximizable?maximizable:false;url=$.acooly.framework.buildCanonicalUrl(url,ajaxData);var saveBtn={id:"acooly-framework-add-btn",text:addB,handler:function(){$.acooly.framework.ajaxSubmitHandler("create",$(this),form,datagrid,reload,onSubmit,onSuccess,onFailure)}};var closeBtn={text:'<i class="fa fa-times-circle fa-lg fa-fw fa-col" ></i>关闭',handler:function(){d.dialog("close")}};var buttons=buttons||[];if(!hideSaveBtn){buttons.push(saveBtn)}buttons.push(closeBtn);var d=null;$.acooly.divdialog=d=$("<div/>").dialog({href:url,title:tt,top:t,width:w,height:h,modal:true,maximizable:max,buttons:buttons,onClose:function(){if(onClose){onClose.call(d)}$(this).dialog("destroy")},onOpen:function(){var that=$(this);$.parser.onComplete=function(){$.acooly.framework.extendCombobox($(that));$.acooly.framework.initPlugins($(that));$.parser.onComplete=function(){}}}})},onSaveSuccess:function(dialog,datagrid,result,reload){var className=$("#"+datagrid).attr("class");if(!className||className==""){return}if(reload){$.acooly.framework.gridReload(datagrid)}else{if(className.indexOf("easyui-treegrid")!=-1){var node=$("#"+datagrid).treegrid("getSelected");if(node){if($("#"+datagrid).treegrid("getChildren",node.id).length>0){$("#"+datagrid).treegrid("reload",node.id)}else{$("#"+datagrid).treegrid("reload",node.parentId)}}else{$("#"+datagrid).treegrid("reload")}}else{$("#"+datagrid).datagrid("insertRow",{index:0,row:result.entity})}}},gridReload:function(datagrid){var className=$("#"+datagrid).attr("class");if(!className||className==""){return}if(className.indexOf("easyui-treegrid")!=-1){$("#"+datagrid).treegrid("reload")}else{$("#"+datagrid).datagrid("reload")}},edit:function(opts){if(opts.entity){$.acooly.framework.doEdit(opts.url,opts.id,"manage_"+opts.entity+"_editform","manage_"+opts.entity+"_datagrid",opts.title,opts.top,opts.width,opts.height,opts.editButton,opts.reload,opts.maximizable,opts.onSubmit,opts.onSuccess,opts.onFail||opts.onFailure,opts.onCloseWindow||opts.onClose,opts.ajaxData,opts.buttons,opts.hideSaveBtn)}else{$.acooly.framework.doEdit(opts.url,opts.id,opts.form,opts.datagrid,opts.title,opts.top,opts.width,opts.height,opts.editButton,opts.reload,opts.maximizable,opts.onSubmit,opts.onSuccess,opts.onFail||opts.onFailure,opts.onCloseWindow||opts.onClose,opts.ajaxData,opts.buttons,opts.hideSaveBtn)}},doEdit:function(url,id,form,datagrid,title,top,width,height,editButton,reload,maximizable,onSubmit,onSuccess,onFailure,onClose,ajaxData,buttons,hideSaveBtn){var t=top?top:null;var w=width?width:500;var h=height?height:"auto";var tt=title?title:"编辑";tt='<i class="fa fa-lg fa-fw fa-col fa-floppy-o" ></i>'+tt;var editB=editButton?editButton:"修改";editB='<i class="fa fa-lg fa-fw fa-col fa-plus-circle" ></i>'+editB;var max=maximizable?maximizable:false;if(!id||id==""){var selectedRow=$.acooly.framework.getSelectedRow(datagrid);if(selectedRow&&selectedRow!=null)id=selectedRow.id}if(!id||id==""){$.acooly.messager("提示","请选择需要编辑的数据","primary");return}var href=$.acooly.framework.getCanonicalUrl(url,id);href=$.acooly.framework.buildCanonicalUrl(href,ajaxData);var saveBtn={id:"acooly-framework-edit-btn",text:editB,handler:function(){$.acooly.framework.ajaxSubmitHandler("edit",$(this),form,datagrid,reload,onSubmit,onSuccess,onFailure)}};var closeBtn={text:'<i class="fa fa-times-circle fa-lg fa-fw fa-col" ></i>关闭',handler:function(){d.dialog("close")}};var buttons=buttons||[];if(!hideSaveBtn){buttons.push(saveBtn)}buttons.push(closeBtn);var d=null;$.acooly.divdialog=d=$("<div/>").dialog({href:href,title:tt,top:t,width:w,height:h,modal:true,maximizable:max,buttons:buttons,onClose:function(){if(onClose){onClose.call(d)}$(this).dialog("destroy")},onOpen:function(){var that=$(this);$.parser.onComplete=function(){$.acooly.framework.extendCombobox($(that));$.acooly.framework.initPlugins($(that));$.parser.onComplete=function(){}}}})},onUpdateSuccess:function(dialog,datagrid,result,reload){var className=$("#"+datagrid).attr("class");if(!className||className==""){return}if(reload){$.acooly.framework.gridReload(datagrid)}else{if(className.indexOf("easyui-treegrid")!=-1){$("#"+datagrid).treegrid("update",{id:result.entity.id,row:result.entity})}else{$("#"+datagrid).datagrid("updateRow",{index:$("#"+datagrid).datagrid("getRowIndex",result.entity.id),row:result.entity})}}},search:function(searchForm,datagrid){try{var defaultFunc=eval(searchForm+"_beforeSubmit");if(defaultFunc&&typeof defaultFunc=="function"&&!defaultFunc.call(this,arguments)){return}}catch(e){}var queryParams=serializeObject($("#"+searchForm));if(isEmptyObject(queryParams)){queryParams=serializeObjectFromContainer($("#"+searchForm))}$.acooly.framework.afterQueryParams[searchForm]=queryParams;if(!this._isDatagrid(datagrid)){$("#"+datagrid).treegrid("load",queryParams)}else{$("#"+datagrid).datagrid("load",queryParams)}},registerKeydown:function(searchForm,datagride){var form=$("#"+searchForm);$("input",form).keydown(function(event){if(event.keyCode==13){$.acooly.framework.search(searchForm,datagride)}})},initPage:function(searchForm,datagride){this.registerKeydown(searchForm,datagride);this.extendCombobox(searchForm);this.initPlugins(searchForm)},exports:function(url,searchForm,fileName,confirmTitle,confirmMessage){var queryParams=$.acooly.framework.afterQueryParams[searchForm];if(isEmptyObject(queryParams)){queryParams=serializeObject($("#"+searchForm))}if(fileName){$(queryParams).attr("exportFileName",fileName)}$.acooly.framework.createAndSubmitForm(url,queryParams)},createAndSubmitForm:function(url,inputObjects){var form=$('<form action="'+contextPath+url+'" method="POST"></form>');var token=$("meta[name='X-CSRF-TOKEN']").attr("content");form.append($('<input type="hidden" name="_csrf" value="'+token+'">'));var xss=false;try{if(typeof eval("filterXSS")=="function"){xss=true}}catch(e){}for(var key in inputObjects){if(inputObjects[key]!=""){var val=inputObjects[key];if(xss){val=filterXSS(val)}var inputForm=$('<input type="hidden" name="'+key+'" value="'+val+'" />');form.append(inputForm)}}form.appendTo($("body")).submit();form.remove()},show:function(url,width,height){return this.get({url:url,width:width,height:height})},get:function(opts){var url=opts.url;var width=opts.width!=null?opts.width:400;var height=opts.height!=null?opts.height:300;var title=opts.title!=null?opts.title:'<i class="fa fa-file-o fa-lg fa-fw fa-col"></i>查看';var buttonLable=opts.buttonLable!=null?opts.buttonLable:"关闭";var d=$("<div/>").dialog({href:contextPath+url,width:width,height:height,modal:true,title:title,buttons:[{text:'<i class="fa fa-times-circle fa-lg fa-fw fa-col" ></i>关闭',handler:function(){d.dialog("close")}}],onClose:function(){$(this).dialog("destroy")}});return d},createUploadify:function(options){var uploadOptions={auto:false,buttonText:"选择文件",fileSizeLimit:10240,fileType:false,height:25,whith:120,uploadLimit:20,queueSizeLimit:20,dnd:true,uploadScript:contextPath+options.url+"&k=v;jsessionid="+options.jsessionid,formData:options.formData,onUploadComplete:function(file,data){var result=$.parseJSON(data);if(result.success){$("#"+options.messager).html(result.message)}else{$("#"+options.messager).html("导入失败:"+result.message)}},onProgress:function(file,e){if(e.lengthComputable){var percent=Math.round(e.loaded/e.total*100);$("#"+options.messager).html("正在上传文件: ["+Math.round(e.loaded/1024)+"K/"+Math.round(e.total/1024)+"K]")}else{$("#"+options.messager).html("正在保存上传数据...")}},onAddQueueItem:function(file){$("#"+options.messager).html(file.name)},onCancel:function(file){$("#"+options.uploader).val("");var $data=$(this).data("uploadifive");var settings=$data.settings;settings.uploadLimit++},onFallback:function(){$("#"+options.messager).html("该浏览器无法使用!")},onError:function(errorType){var msg=errorType;var $data=$(this).data("uploadifive");var settings=$data.settings;if(errorType=="QUEUE_LIMIT_EXCEEDED"){msg="最多只能选择"+settings.uploadLimit+"个文件！"}else if(errorType=="FILE_SIZE_LIMIT_EXCEEDED"){msg="视频最大不允许超过:"+settings.fileSizeLimit/1024/1024+"MB！"}$("#"+options.messager).html(msg)}};var uploadfiveOptions=$.extend(uploadOptions,options);if(!uploadfiveOptions.queueID){uploadfiveOptions.queueID=false}$("#"+options.uploader).uploadifive(uploadfiveOptions)},imports_dialog:"",imports:function(opts){var w=opts.width?opts.width:400;var h=opts.height?opts.height:280;var load=opts.datagrid?true:false;$.acooly.framework.imports_dialog=$("<div/>").dialog({href:contextPath+opts.url,width:w,height:h,modal:true,title:opts.title?opts.title:'<i class="fa fa-cloud-upload fa-lg fa-fw fa-col"></i> 数据导入',buttons:[{text:'<i class="fa fa-arrow-circle-o-up fa-lg fa-fw fa-col"></i> 上传导入',handler:function(){let uploadifiveOptions=$("#"+opts.uploader).data("uploadifive").settings;if(uploadifiveOptions.onFormData){var data=uploadifiveOptions.onFormData.call(this);if(uploadifiveOptions.formData){data=$.extend(uploadifiveOptions.formData,data)}$("#"+opts.uploader).data("uploadifive").settings.formData=data}$("#"+opts.uploader).uploadifive("upload")}},{text:'<i class="fa fa-times-circle fa-lg fa-fw fa-col" ></i> 关闭',handler:function(){$.acooly.framework.imports_dialog.dialog("close")}}],onClose:function(){if(load){$.acooly.framework.gridReload(opts.datagrid)}$(this).dialog("destroy")}})},confirmSubmit:function(url,id,datagrid,confirmTitle,confirmMessage,successCallBack){var title=confirmTitle?confirmTitle:"确定";var message=confirmMessage?confirmMessage:"您是否要提交该操作？";$.messager.confirm(title,message,function(r){if(r){$.ajax({url:contextPath+url,data:{id:id},success:function(result){if(typeof result=="string")result=eval("("+result+")");if(result.success){var className=$("#"+datagrid).attr("class");if(className.indexOf("easyui-treegrid")!=-1){$("#"+datagrid).treegrid("reload")}else{$("#"+datagrid).datagrid("reload")}if(successCallBack){successCallBack.call(this)}}if(result.message){$.acooly.messager("提示",result.message,result.success?"success":"danger")}}})}})},confirmRequest:function(url,requestData,datagrid,confirmTitle,confirmMessage,onSuccess,onFailure){var title=confirmTitle?confirmTitle:"确定";var message=confirmMessage?confirmMessage:"您是否要提交该操作？";$.messager.confirm(title,message,function(r){if(r){$.ajax({url:contextPath+url,data:requestData,success:function(result){if(result.success){$("#"+datagrid).datagrid("reload");$("#"+datagrid).datagrid("uncheckAll").datagrid("unselectAll").datagrid("clearSelections");if(onSuccess){onSuccess.call(this,arguments)}}else{if(onFailure){onFailure.call(this,arguments)}}if(result.message){$.acooly.messager("提示",result.message,result.success?"success":"danger")}}})}})},move:function(url,id,datagrid,confirmTitle,confirmMessage){$.post(url,{id:id},function(result){if(result.success){var className=$("#"+datagrid).attr("class");if(className.indexOf("easyui-treegrid")!=-1){var node=$("#"+datagrid).treegrid("getSelected");var parent=$("#"+datagrid).treegrid("getParent",node.id);if(parent){$("#"+datagrid).treegrid("reload",parent.id)}else{$("#"+datagrid).treegrid("reload")}}else{$("#"+datagrid).datagrid("reload")}}if(result.message){$.acooly.messager("提示",result.message,result.success?"success":"danger")}})},remove:function(url,ids,datagrid,confirmTitle,confirmMessage,successCallBack){$.acooly.framework.confirmSubmit(url,ids,datagrid,confirmTitle,confirmMessage,successCallBack)},removes:function(url,datagrid,confirmTitle,confirmMessage,successCallBack){var rows=$.acooly.framework._getCheckedRows(datagrid);var ids=[];if(rows.length>0){for(var i=0;i<rows.length;i++){ids.push(rows[i].id)}$.acooly.framework.remove(url,ids.join(","),datagrid,confirmTitle,confirmMessage,successCallBack)}else{$.acooly.messager("提示","请勾选要删除的记录","warning")}},logout:function(){$.messager.confirm("提醒","确定要注销退出吗？",function(r){if(r){window.location.href=contextPath+"/manage/logout.html"}})},ajaxLogout:function(queryString){$.messager.confirm("提醒","确定要注销退出吗？",function(r){if(r){$.ajax({url:contextPath+"/manage/logout.html",success:function(data,txtStatus){console.info("txtStatus:"+txtStatus);if(queryString){window.location.href=contextPath+"/manage/login.html?"+queryString}else{window.location.href=contextPath+"/manage/login.html"}}})}})},changePassword:function(){var d=$("<div/>").dialog({href:contextPath+"/manage/system/changePasswordView.html",width:400,height:400,modal:true,title:' <i class="fa fa-lock fa-lg"></i> 修改密码',buttons:[{text:'<i class="fa fa-check fa-col"></i> 提交',handler:function(){$("#user_changePassword_form").ajaxSubmit({beforeSubmit:function(formData,jqForm,options){return $("#user_changePassword_form").form("validate")},success:function(result,statusText){try{if(result.success){d.dialog("destroy");$.messager.alert("修改密码","密码修改成功，请重新登录","info",function(){window.location.href=contextPath+"/manage/logout.html"})}else{$.acooly.framework.changePasswordCaptcha();$.acooly.messager("提示",result.message,"danger")}}catch(e){$.acooly.framework.changePasswordCaptcha();$.acooly.messager("错误",result,"danger")}},error:function(XmlHttpRequest,textStatus,errorThrown){$.acooly.messager("错误",errorThrown,"danger")}})}}],onClose:function(){$(this).dialog("destroy")},onLoad:function(){}})},changePasswordCaptcha:function(){$("#user_changePassword_jcaptchaImage").show();$("#user_changePassword_jcaptchaImage").attr("src","/jcaptcha.jpg?"+new Date);$("#user_changePassword_passwordCaptcha").val("")},kingEditor:function(opts){$.acooly.editor.kindEditor(opts)},getSelectedRow:function(grid){var className=$("#"+grid).attr("class");if(className=="easyui-treegrid"){return $("#"+grid).treegrid("getSelected")}else{return $("#"+grid).datagrid("getSelected")}},getSelectedTabIndex:function(tabsId){var tab=$("#"+tabsId).tabs("getSelected");return $("#"+tabsId).tabs("getTabIndex",tab)},fireSelectRow:function(gridId,selectedCallBack,errorMessage){var row=$.acooly.framework.getSelectedRow(gridId);if(!row){var msg="请先选择操作的数据行";if(errorMessage)msg=errorMessage;$.acooly.messager("提示",msg,"warning");return null}selectedCallBack.call(this,row)},_getCheckedRows:function(grid){var className=$("#"+grid).attr("class");if(className=="easyui-treegrid"){return $("#"+grid).treegrid("getSelections")}else{return $("#"+grid).datagrid("getSelections")}},reloadGrid:function(grid){var className=$("#"+datagrid).attr("class");if(className.indexOf("easyui-treegrid")!=-1){$("#"+grid).treegrid("reload")}else{$("#"+grid).datagrid("reload")}},loadGrid:function(opts){var data={sort:"id",order:"desc",page:1,rows:20};$.extend(data,opts.ajaxData);$.ajax({url:opts.url+"?"+new Date,data:data,beforeSend:function(){$("#"+opts.gridId).datagrid("loading")},complete:function(){$("#"+opts.gridId).datagrid("loaded")},success:function(result){if(result.success){$("#"+opts.gridId).datagrid("loadData",result)}else{$.messager.show({title:"提示",msg:result.message})}},error:function(r,e){$.messager.show({title:"提示",msg:e})}})},getCanonicalUrl:function(url,id){url=contextPath+url;url+=url.indexOf("?")!=-1?"&":"?";url+="id="+id;return url},buildCanonicalUrl:function(url,ajaxData){var data={};$.extend(data,ajaxData);url=contextPath+url;url+=url.indexOf("?")!=-1?"":"?";for(var k in data){url+="&"+k+"="+data[k]}return url},renderDynamic:function(container){let obj=container&&container.jquery?container:$("#"+container);$(obj).find(".select2bs4").select2({theme:"bootstrap4"});$(obj).find("[data-mask]").inputmask();$.parser.parse($("#"+$(obj).attr("id")))},getFormItem:function(form,formItemName){var itemObj=$("#"+form+" input[name='"+formItemName+"']");if(itemObj.length==0){itemObj=$("#"+form+" select[name='"+formItemName+"']")}if(itemObj.length==0){itemObj=$("#"+form+" textarea[name='"+formItemName+"']")}if(!itemObj.attr("class")&&$(itemObj).prev()&&$(itemObj).prev().attr("class")&&$(itemObj).prev().attr("class").indexOf("easyui-numberbox")>=0){itemObj=$(itemObj).prev()}if(itemObj.attr("class")&&itemObj.attr("class").indexOf("combo-value")>=0&&$(itemObj).parent()&&$(itemObj).parent().prev()&&$(itemObj).parent().prev().attr("class")&&$(itemObj).parent().prev().attr("class").indexOf("easyui-combobox")>=0){itemObj=$(itemObj).parent().prev()}return itemObj},getFromItemValue:function(form,formItemName){var itemObj=this.getFormItem(form,formItemName);var itemClass=itemObj.attr("class");var itemValue;if(itemClass.indexOf("easyui-combobox")>=0){itemValue=$(itemObj).combobox("getValue")}else if(itemClass.indexOf("easyui-numberbox")>=0){itemValue=$(itemObj).numberbox("getValue")}else{itemValue=itemObj.val()}return itemValue},setFormItemValue:function(form,formItemName,formItemValue){var itemObj=this.getFormItem(form,formItemName);var itemClass=itemObj.attr("class");var itemValue;if(itemClass.indexOf("easyui-combobox")>=0){itemValue=$(itemObj).combobox("select",formItemValue)}else if(itemClass.indexOf("easyui-numberbox")>=0){itemValue=$(itemObj).numberbox("setValue",formItemValue)}else{itemValue=itemObj.val(formItemValue)}},setFormItemDefaultValue:function(form,formItemName,formItemValue){var itemValue=this.getFromItemValue(form,formItemName);if(!itemValue&&itemValue==""){this.setFormItemValue(form,formItemName,formItemValue)}},_isDatagrid:function(datagrid){var className=$("#"+datagrid).attr("class");return className&&className.indexOf("easyui-datagrid")!=-1},selectPage:function(inputId,data,opts){let defOpts={pagination:false,listSize:10,multiple:false,data:data,formatItem:function(row){if(opts&&opts.formatter){return opts.formatter.call(this,row)}else{return opts.showField}},eSelect:function(row){if(opts&&opts.onSelect){opts.onSelect.call(this,row)}},eClear:function(){if(opts&&opts.onClear){opts.onClear.call(this)}}};let options=$.extend(defOpts,opts);$("#"+inputId).selectPage(options)},extendCombobox:function(container){var obj=container&&container.jquery?container:$("#"+container);$(obj).find(".easyui-combobox").combobox({onLoadSuccess:function(){if($(this).attr("style").indexOf("width")!=-1){return}let originalWidth=$(this).next().css("width");if(originalWidth){if(originalWidth.indexOf("px")!=-1){originalWidth=originalWidth.substring(0,originalWidth.indexOf("px"));const newWidth=parseInt(originalWidth)+20;$(this).combobox("resize",newWidth)}}}})},initSelect:function(container){var obj=container&&container.jquery?container:$("#"+container);$(obj).find(".select2bs4").select2({theme:"bootstrap4"});$(obj).find("[data-mask]").inputmask()},initPlugins:function(container){let obj=container&&container.jquery?container:$("#"+container);$(obj).find(".select2bs4").select2({theme:"bootstrap4"});$(obj).find("[data-mask]").inputmask();$('[data-toggle="tooltip"]').tooltip();if(bsCustomFileInput){bsCustomFileInput.init()}$.acooly.framework.wordsCount(container)},wordsCount:function(container){let obj=container&&container.jquery?container:$("#"+container);$.each(obj.find(".form-words"),function(index,e){var count=$(e).data("words");if(count){$(e).after("<div style='text-align: right;padding: 2px 5px;'>剩余字数：<span>"+count+"</span></div>");$(e).on("input focus keyup",function(){let length=$(this).val().length;let num=count-length;$(this).next().find("span").html(num)});$(e).trigger("keyup")}})},play:function(resourceUrl,opts){if(!resourceUrl){return}var url=resourceUrl;if(resourceUrl.indexOf("?")!=-1){url=resourceUrl.split("?")[0]}let urlArr=url.split("/");let filename=urlArr[urlArr.length-1];let defOpts={width:800,height:600,title:" <i class='fa fa-play' aria-hidden='true'></i> 播放："+filename,showCloseBtn:true};let options=$.extend(defOpts,opts);if(options.showCloseBtn){options.buttons=[{text:'<i class="fa fa-times-circle fa-lg fa-fw fa-col" ></i>关闭',handler:function(){d.dialog("close")}}]}options.content="<a class='media' href='"+resourceUrl+"'></a>";options.onClose=function(){$(this).dialog("destroy")};options.onOpen=function(){$(".media").media({width:options.width,height:options.height})};var d=$("<div/>").dialog(options)},getInputByName:function(containerId,inputName){return $("#"+containerId+' input[name="'+inputName+'"]')}}})})(jQuery);Inputmask.extendAliases({money:{prefix:"",rightAlign:false,groupSeparator:"",alias:"currency"},integer:{alias:"numeric",digits:0,rightAlign:false,radixPoint:""},percent:{alias:"percentage",digits:0,rightAlign:false,suffix:""},centPercent:{alias:"percentage",rightAlign:false,suffix:""},bankCard:{mask:"9999 9999 9999 (9{1,3})|(9{4} 9{0,3})|(9{4} 9{4} 9{0,3})",autoUnmask:true},bankcard:{alias:"bankCard"},mobile:{mask:"99999999999",autoUnmask:true},cert:{mask:"99999999999999999*",autoUnmask:true},idcard:{alias:"cert"},account:{mask:"a*{0,31}",autoUnmask:false,definitions:{a:{validator:"[A-Za-z]"}}},url:{regex:"https{0,1}://.*",autoUnmask:false}});(function($){$.extend($.acooly,{layout:{menus:[],selectedMenu:{id:null,name:null},loadMenu:function(defaultMenuId){$("#mainMenu").empty();$.ajax({url:contextPath+"/manage/system/authorisedMenus.html",async:false,success:function(data,textStatus){if(typeof data=="string"){data=eval("("+data+")")}var a="";$(data).each(function(i,domEle){if(domEle.children&&domEle.children.length>0){$.acooly.layout.menus.push(domEle);if(domEle.iconSkin!=null){a+="<a id='mainMenu_"+domEle.id+"' href=\"javascript:$.acooly.layout.loadTree('"+domEle.id+"','"+domEle.name+'\');" class="'+(i==1?"buttonaft":"button")+'">'+"<span><i class='fa "+domEle.iconSkin+"'></i>  "+domEle.name+"</span></a>"}else{a+="<a id='mainMenu_"+domEle.id+"' href=\"javascript:$.acooly.layout.loadTree('"+domEle.id+"','"+domEle.name+'\');" class="'+(i==1?"buttonaft":"button")+'">'+"<span><img src='"+$.acooly.layout.getIconPath(domEle.icon)+"'/>"+domEle.name+"</span></a>"}if(defaultMenuId&&defaultMenuId==domEle.id){$.acooly.layout.selectedMenu=domEle}if(!defaultMenuId&&i==0){$.acooly.layout.selectedMenu=domEle}}});$("#mainMenu").html(a)}})},loadTree:function(parentId,name){if(!parentId){parentId=$.acooly.layout.selectedMenu.id}if(parentId){$("#mainMenu").children("a").attr("class","button");$("#mainMenu_"+parentId).attr("class","buttonaft")}var setting={view:{showLine:true},callback:{onClick:function(event,treeId,treeNode,clickFlag){$.acooly.layout.accessResource(treeNode)}}};var data=null,i=0;while(data==null&&i<3){data=$.acooly.layout.getTree(parentId);i++}$.fn.zTree.init($("#layout_west_tree"),setting,data.children);var zTree=$.fn.zTree.getZTreeObj("layout_west_tree");zTree.expandAll(true)},reloadMenu:function(){$.acooly.layout.loadMenu($.acooly.layout.selectedMenu.id);$.acooly.layout.loadTree($.acooly.layout.selectedMenu.id)},getTree:function(id){var selectMenu=$.acooly.layout.menus[0];$($.acooly.layout.menus).each(function(i,menu){if(menu.id==id){selectMenu=menu}});$.acooly.layout.selectedMenu=selectMenu;return selectMenu},accessResource:function(node){var type=node.type;if(type=="MENU")return;var url=node.value;if(!url||url=="")return;var opts={title:node.name,closable:true,iconCls:node.icon!=null&&node.icon.indexOf("fa")!=-1?"fa "+node.icon:node.icon};if(node.showMode==1){opts.href=contextPath+url}else{opts.content='<iframe src="'+url+'" frameborder="0" style="border:0;width:100%;height:99%;" ></iframe>'}$.acooly.layout.addTab(opts)},createTree:function(){$.acooly.westTree=$("#layout_west_tree").tree({parentField:"id",lines:true,onClick:function(node){var url=node.attributes.url;if(!url||url=="")return;var opts={title:node.text,closable:true,iconCls:node.iconCls};if(node.attributes.loadMode==1){opts.href=contextPath+url}else{opts.content='<iframe src="'+url+'" frameborder="0" style="border:0;width:100%;height:99%;"></iframe>'}$.acooly.layout.addTab(opts)}})},addTab:function(opts){var t=$("#layout_center_tabs");if(t.tabs("exists",opts.title)){t.tabs("select",opts.title)}else{$.extend(opts,{onLoadError:function(e,x,y){$.acooly.layout.closeTab();$.acooly.messager("错误","请求的功能不存在或没有权限","danger")}});t.tabs("add",opts)}},selectTab:function(title){$("#layout_center_tabs").tabs("select",title)},getSelectTab:function(){return $("#layout_center_tabs").tabs("getSelected").panel("options")},refreshTab:function(title){$("#layout_center_tabs").tabs("getTab",title).panel("refresh")},closeTab:function(){var index=$("#layout_center_tabs").tabs("getTabIndex",$("#layout_center_tabs").tabs("getSelected"));if(index<=0){return}var tab=$("#layout_center_tabs").tabs("getTab",index);if(tab.panel("options").closable){$("#layout_center_tabs").tabs("close",index)}else{$.messager.alert("提示","["+tab.panel("options").title+"]不可以被关闭","error")}},getIconPath:function(icoCls){if(!icoCls||icoCls.indexOf("-")==-1){return null}return"/manage/assert/style/"+icoCls.split("-").join("/")+".png"}}})})(jQuery);var panels=[];function acooly_portal_init(){$.ajax({url:contextPath+"/manage/system/portallets.html",success:function(result){panels=result;$("#layout_portal_portal").portal({border:false,fit:true,onStateChange:function(){var portalState=getPortalState();$.cookie("portal-state",portalState,{expires:7})}});var state=$.cookie("portal-state");if(!state||!checkPortalletCookie(state)){state=getDefaultStates()}addPortalPanels(state);$("#layout_portal_portal").portal("resize")}})}function getPanelOptions(id){for(var i=0;i<panels.length;i++){if(panels[i].id==id){return panels[i]}}return undefined}function checkPortalletCookie(portalState){var columns=portalState.split(":");var x=0;for(var i=0;i<columns.length;i++){var cc=columns[i].split(",");for(var j=0;j<cc.length;j++){x++;var options=getPanelOptions(cc[j]);if(!options){return false}}}if(x!=panels.length){return false}return true}function cleanPortalletCookie(){$.cookie("portal-state","")}function getDefaultStates(){var aa=[];var cc=[];var mid=0;if(panels.length>2){mid=panels.length%2==0?panels.length/2:(panels.length-1)/2}for(var i=0;i<panels.length;i++){cc.push(panels[i].id);if(i==mid){aa.push(cc.join(","));cc=[]}}aa.push(cc.join(","));var result=aa.join(":");return result}function getPortalState(){var aa=[];for(var columnIndex=0;columnIndex<2;columnIndex++){var cc=[];var panels=$("#layout_portal_portal").portal("getPanels",columnIndex);for(var i=0;i<panels.length;i++){cc.push(panels[i].attr("id"))}aa.push(cc.join(","))}return aa.join(":")}function addPortalPanels(portalState){var columns=portalState.split(":");for(var columnIndex=0;columnIndex<columns.length;columnIndex++){var cc=columns[columnIndex].split(",");for(var j=0;j<cc.length;j++){var options=getPanelOptions(cc[j]);if(options){var p=$("<div/>").attr("id",options.id).appendTo("body");if(options.loadMode==1){if(options.showMode==2){var url=options.href;options.href="";options.content='<iframe src="'+url+'" frameborder="0" style="border:0;width:100%;height:99%;"></iframe>'}}else{options.href="";options.content='<pre style="margin:5px;font-size:14px;">'+options.content+"</pre>"}p.panel(options);$("#layout_portal_portal").portal("add",{panel:p,columnIndex:columnIndex})}}}}var acooly_layui={loadingId:"",loading:function(msg){if(!msg)msg="加载中…";this.loadingId=layer.msg(msg,{icon:16,shade:.01});return this.loadingId},loaded:function(id){if(id){layer.close(id);return}if(this.loadingId){layer.close(this.loadingId);return}layer.closeAll()},msg:function(message,icon){if(!icon){icon=0}layer.msg(message,{icon:icon,closeBtn:1})},toast:function(message,type,callBack){layer.msg(message,{icon:icon,closeBtn:1})},tips:function(content,objectId,position){if(!position){position=2}layer.tips(content,objectId,{tips:position,style:["background-color:#81af43; color:#fff","#81af43"],maxWidth:200,closeBtn:[1,true]})}};$.extend($.acooly,acooly_layui);let system_user_class={orgTreeBoxInit:function(treeboxId,isSearch,defVal){$.ajax({url:"/manage/module/security/org/listJson.html",data:{sort:"id",order:"asc"},method:"post",success:function(result){let nodes=result.rows;if(isSearch){nodes.push({id:0,parentId:-1,name:"所有"})}$("#"+treeboxId).select2ztree({theme:"bootstrap4",textField:"name",valueField:"id",ztree:{setting:{data:{simpleData:{enable:true,pIdKey:"parentId",rootPId:0}}},zNodes:nodes}});if(defVal){$("#"+treeboxId).val(defVal).trigger("change")}}})},changePasswd:function(id){$("#manage_user_datagrid").datagrid("uncheckAll").datagrid("unselectAll").datagrid("clearSelections");var d=$("<div/>").dialog({href:"/manage/system/user/showChangePassword.html?id="+id,width:450,height:350,modal:true,title:' <i class="fa fa-lock fa-lg"></i> 重置用户密码',buttons:[{text:'<i class="fa fa-check fa-col"></i> 提 交',handler:function(){$("#manage_user_changePassword_form").ajaxSubmit({beforeSubmit:function(){return $("#manage_user_changePassword_form").form("validate")},success:function(result){$.acooly.messager("修改密码",result.message,result.success?"success":"danger");if(result.success){d.dialog("destroy")}},error:function(XmlHttpRequest,textStatus,errorThrown){$.acooly.messager("错误",errorThrown,"danger")}})}}],onClose:function(){$(this).dialog("destroy")}})}};let system_resource_class={manage_resource_tree_expand_state:true,treeToggle:function(obj){let zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");zTree.expandAll(!this.manage_resource_tree_expand_state);if(!this.manage_resource_tree_expand_state){$(obj).html('<i class="fa fa-minus-square-o fa-fw fa-col"></i> 全部折叠')}else{$(obj).html('<i class="fa fa-plus-square-o fa-fw fa-col"></i> 全部展开')}this.manage_resource_tree_expand_state=!this.manage_resource_tree_expand_state},formMove:function(sourceNode,targetNode,moveType){if(!moveType||moveType==null)return;$.ajax({url:"/manage/system/resource/move.html",data:{sourceId:sourceNode.id,targetId:targetNode.id,moveType:moveType},success:function(data,status){if(data.success){console.info("save move success!")}}})},formCreate:function(isRoot){$("#manage_resource_editform").form("reset");let node=$.acooly.system.resource.getSelectedNode();if(isRoot||!node){let zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");zTree.cancelSelectedNode();$("#manage_resource_node_parentId").val("");$("#manage_resource_node_parentName").html("根节点")}else{$("#manage_resource_node_parentName").html(node.name);$("#manage_resource_node_parentId").val(node.id)}$("#manage_resource_node_id").val("");$("#resource_icons_font .icon-elm").removeAttr("checked");$("#manage_resource_form_icon_first").prop("checked","checked");$("#manage_resource_form_showState").val("0").trigger("change");$("#manage_resource_form_type").val("URL").trigger("change");this._resourceTypeChange("URL");$("#manage_resource_form_showMode").val("1").trigger("change")},formBind:function(resource){try{$("#manage_resource_editform").form("load",resource)}catch(e){}$("#manage_resource_form_showState").val(resource.showState).trigger("change");$("#manage_resource_form_type").val(resource.type).trigger("change");this._resourceTypeChange(resource.type);$("#manage_resource_form_showMode").val(resource.showMode).trigger("change");$("input",$("#manage_resource_form_icon_container")).each(function(){if(this.value==resource.icon||this.value==resource.iconSkin){$(this).attr("checked","true");return}});let zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");if(resource.parentId){var node=zTree.getNodeByParam("id",resource.parentId,null);$("#manage_resource_node_parentName").html(node.name)}else{$("#manage_resource_node_parentName").html("根节点")}},formSave:function(){$("#manage_resource_editform").ajaxSubmit({beforeSubmit:function(formData,jqForm,options){var result=$("#manage_resource_editform").form("validate");if(!result){return result}var type=null;var value=null;for(var i;i<formData.length;i++){var e=formData[i];if(e.name=="type"){type=e.value}if(e.name=="value"){value=e.value}}if(type!="MENU"&&value==""){$.acooly.msgrb("非菜单资源，资源值不能为空",false);return false}return result},success:function(result,statusText){if(typeof result=="string"){result=eval("("+result+")")}if(result.success){var zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");var nodeId=$("#manage_resource_node_id").val();if(nodeId&&nodeId!=""){var node=zTree.getNodeByParam("id",result.entity.id,null);if(result.entity.icon){if(result.entity.icon.startsWith("icon")){node.icon=result.entity.icon;node.iconSkin=null}else{node.icon=null;node.iconSkin=result.entity.icon}}if(result.entity.name){node.name=result.entity.name}if(result.entity.showState){node.showState=result.entity.showState}node.value=result.entity.value;zTree.updateNode(node)}else{var pNode=$.acooly.system.resource.getSelectedNode();var nNode=result.entity;if(nNode.icon){if(nNode.icon.startsWith("icon")){nNode=nNode.icon;nNode.iconSkin=null}else{nNode.iconSkin=nNode.icon;nNode.icon=null}}zTree.addNodes(pNode,nNode);$("#manage_resource_node_id").val(result.entity.id)}}if(result.message)$.acooly.messager("提示",result.message,result.success?"success":"danger")}})},treeDelete:function(id){$.messager.confirm("确认","你确认删除该资源？\t",function(r){if(!r)return;$.ajax({url:"/manage/system/resource/deleteJson.html?id="+id,success:function(result,status){if(typeof result=="string"){result=eval("("+result+")")}if(result.success){var zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");var node=zTree.getNodeByParam("id",id,null);zTree.removeNode(node)}if(result.message)$.acooly.messager("提示",result.message,result.success?"success":"danger")}})})},getSelectedNode:function(){let node;let zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");let nodes=zTree.getSelectedNodes();if(nodes&&nodes.length>0){node=nodes[0]}return node},loadTree:function(defaultNode,clear){$.ajax({url:"/manage/system/resource/listAllJson.html",success:function(data,status){if(data.success){$.fn.zTree.init($("#manage_resource_tree"),$.acooly.system.resource.zTreeSetting,data.rows);var zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");zTree.expandAll(true);if(defaultNode){zTree.selectNode(defaultNode,true)}else{$.acooly.system.resource.formCreate(true)}}}})},init:function(){var that=this;$.acooly.framework.initPlugins("manage_resource_editform");$("#manage_resource_form_type").on("select2:select",function(evt){if(!evt){return}let id=evt.params.data.id;that._resourceTypeChange(id)})},_resourceTypeChange:function(resourceType){if(!resourceType){resourceType=$("#manage_resource_form_type").val()}if(!resourceType){return}var isRequired=resourceType!="MENU";$("#manage_resource_form_value").validatebox("options").required=isRequired;$("#manage_resource_form_value").validatebox("validate")},zTreeSetting:{view:{showLine:true,showIcon:true,addHoverDom:function(treeId,treeNode){let aObj=$("#"+treeNode.tId+"_a");if($("#manage_resource_add_Btn_"+treeNode.id).length==0){let html="<a id='manage_resource_add_Btn_"+treeNode.id+"' href='javascript:;' onclick='$.acooly.system.resource.formCreate();return false;' style='margin:0 0 0 5px;padding-top: 2px;'><i class=\"fa fa-plus-circle\"></i></a>";aObj.after(html)}if(!treeNode.children||treeNode.children.length==0){if($("#manage_resource_delete_Btn_"+treeNode.id).length>0)return;let html="<a id='manage_resource_delete_Btn_"+treeNode.id+"' href='javascript:;' onclick='$.acooly.system.resource.treeDelete("+treeNode.id+");return false;' style='margin:0 0 0 5px;padding-top: 2px;'><i class=\"fa fa-minus-circle\"></i></a>";aObj.append(html)}},removeHoverDom:function(treeId,treeNode){if($("#manage_resource_add_Btn_"+treeNode.id).length>0)$("#manage_resource_add_Btn_"+treeNode.id).unbind().remove();if(treeNode.children&&treeNode.children.length==0)$("#manage_resource_delete_Btn_"+treeNode.id).unbind().remove()},fontCss:function(treeId,treeNode){return treeNode.showState==1?{color:"gray"}:{color:"black"}}},edit:{enable:true,showRemoveBtn:false,showRenameBtn:false},callback:{onClick:function(event,treeId,treeNode,clickFlag){$.acooly.system.resource.formBind(treeNode)},onDrop:function(event,treeId,treeNodes,targetNode,moveType){$.acooly.system.resource.formMove(treeNodes[0],targetNode,moveType)}}}};let system_class={user:system_user_class,resource:system_resource_class,config:{},init:function(){this.globalSetting();this.loadSecurityConfig()},loadSecurityConfig:function(){var That=this;$.ajax({url:contextPath+"/security/config/index.html",success:function(data,textStatus){if(typeof data=="string"){data=eval("("+data+")")}That.config=data;var acoolyTheme=$.acooly.admin.theme.getTheme($.acooly.admin.theme.acoolyThemeKey);if(acoolyTheme&&acoolyTheme.indexOf("easyui")==-1){$.acooly.admin.init()}}})},globalSetting:function(){$(document).ajaxComplete(function(event,xhr,settings){var sessionState=xhr.getResponseHeader("SessionState");if(sessionState){let msg=sessionState=="1"?"会话过期，请重新登录":"已有相同用户登录，强制注销";$.messager.alert("提示",msg,"info",function(){window.location.href="/manage/logout.html"})}});var token=$("meta[name='X-CSRF-TOKEN']").attr("content");$(document).ajaxSend(function(e,xhr,options){xhr.setRequestHeader("X-CSRF-TOKEN",token)})},getCSRFToken:function(){return $("meta[name='X-CSRF-TOKEN']").attr("content")}};(function($){if(!$.acooly){$.acooly={}}if(!$.acooly.system){$.extend($.acooly,{system:system_class})}})(jQuery);function manage_resource_tree_reload(){var zTree=$.fn.zTree.getZTreeObj("manage_resource_tree");zTree.refresh()}var acooly_template={engine:"baidu",_doRender:function(template,data,engineOpts){if(this.engine=="baidu"){return this._doBaiduRender(template,data,engineOpts)}return null},_doBaiduRender:function(template,data,engineOpts){baidu.template.ESCAPE=false;baidu.template.LEFT_DELIMITER="<%";baidu.template.RIGHT_DELIMITER="%>";if(engineOpts){$.each(engineOpts,function(k,v){var cmd="baidu.template."+k+"="+v;eval(cmd)})}return baidu.template(template,data)},render:function(template,data,opts,engineOpts){var defOpts={engine:null,append:false,beforeRender:null,afterRender:null};var options=$.extend(defOpts,opts);if(options.beforeRender){options.beforeRender.call(this,data)}if(options.engine){this.engine=options.engine}var result=this._doRender(template,data,engineOpts);if(options.afterRender){options.afterRender.call(this,data,result)}return result},renderTo:function(container,template,data,opts,engineOpts){var defOpts={engine:null,append:false,beforeRender:null,afterRender:null};var options=$.extend(defOpts,opts);var result=this.render(template,data,opts,engineOpts);if(options.append){$("#"+container).append(result)}else{$("#"+container).html(result)}}};(function($){if(!$.acooly){$.extend({acooly:{}})}$.extend($.acooly,{template:acooly_template})})(jQuery);var acooly_msg={loadingId:"",loading:function(msg){},loaded:function(id){},msg_data:{default:{title:"信息",defaultContent:"",icon:"fa fa-info-circle"},success:{title:"成功",defaultContent:"处理成功",icon:"fa fa-check-circle"},info:{title:"提示",defaultContent:"",icon:"fa fa-info-circle"},warning:{title:"警告",defaultContent:"",icon:"fa fa-exclamation-circle"},primary:{title:"信息",defaultContent:"",icon:"fa fa-info-circle"},danger:{title:"失败",defaultContent:"处理失败",icon:"fa fa-times-circle"}},messager:function(title,message,type){var args=arguments;var ctype;if(args.length==1){ctype="primary";data=this.msg_data[ctype];data.message=title}else if(args.length==2){ctype=message;data=this.msg_data[ctype];data.message=title}else{ctype=!type?"primary":type;data=this.msg_data[ctype];data.title=title?title:data.title;data.message=message?message:data.defaultContent}var html='<div role="alert" class="ac-notification right" style="top: 57px;right: 55px; z-index: 12150;display: none ">\n'+'    <i class="'+data.icon+" ac-notification__icon text-"+ctype+'"></i>\n'+'    <div class="ac-notification__group is-with-icon">\n'+'        <h2 class="ac-notification__title">'+data.title+"</h2>\n"+'        <div class="ac-notification__content"><p>'+data.message+"</p></div>\n"+"        <i onclick='$(this).parent().parent().remove();' class=\"ac-notification__closeBtn ion ion-android-close\"></i>\n"+"    </div>\n"+"</div>";var manager=$(html).appendTo("body");$(manager).show().delay(3e3).fadeOut(function(){$(manager).remove()})},msg:function(message,icon){$.messager.alert("消息",message)},msgrb:function(message,success,title){$.messager.show({title:title==null?"提示":title,msg:message,timeout:4e3,showType:"slide"})},alert:function(title,message,opts){$.messager.alert(title,message,opts)},tips:function(content,objectId,position){},toast:function(title,message,type,position){ctype=!type?"default":type;data=this.msg_data[ctype];data.title=title?title:data.title;data.message=message?message:data.message;$(document).Toasts("create",{class:"bg-"+ctype,icon:data.icon+" fa-lg",autohide:true,delay:3e3,title:data.title,body:data.message})}};(function($){if(!$.acooly){$.extend({acooly:{}})}$.extend($.acooly,acooly_msg)})(jQuery);var acooly_verify={pattens:{cert15:/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$/,cert18:/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[x,X])$/,phone:/^(^0\d{2}-?\d{8}$)|(^0\d{3}-?\d{7}$)|(^0\d2-?\d{8}$)|(^0\d3-?\d{7}$)$/,mobile:/^1[2|3|4|5|6|7|8|9]\d{9}$/,account:/^[a-zA-Z][\w]+$/,member:/^[a-zA-Z0-9]+$/,chs:/^[\u0391-\uFFE5]+$/,csv:/^[\w,\$,\{,\},_,\u4e00-\u9fa5]+(,[\w,\$,\{,\},_,\u4e00-\u9fa5]+)*$/,money:/^-?(([1-9]\d{0,9})|0)(\.\d{1,2})?$/},regExp:function(value,pattern){var re=new RegExp(pattern);var result=re.test(value);return re.test(value)},regVerify:function(value,patternName){return this.pattens[patternName].test(value)},byteLength:function(value,minlen,maxlen){if(value==null){return false}var l=value.length,blen=0;for(i=0;i<l;i++){if((value.charCodeAt(i)&65280)!=0){blen++}blen++}return!(blen>maxlen||blen<minlen)},cert:function(value){return this.pattens.cert15.test(value)||this.pattens.cert18.test(value)},phone:function(value){return this.pattens.phone.test(value)},mobile:function(value){return this.pattens.mobile.test(value)},account:function(value){return this.pattens.account.test(value)},member:function(value){return this.pattens.member.test(value)},chs:function(value){return this.pattens.chs.test(value)},csv:function(value){return this.pattens.csv.test(value)},money:function(value){return this.pattens.money.test(value)},number:function(value){return/^[0-9]*$/.test(value)},decimal:function(value){return/^(-?\d+)(\.\d+)?$/.test(value)},password_security_level:{higRegex:"^(?=.{8,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$",midRegex:"^(?=.{8,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$",lowRegex:"(?=.{8,}).*"},password:function(password){if(new RegExp(this.password_security_level.higRegex,"g").test(password)){return 3}else if(new RegExp(this.password_security_level.midRegex,"g").test(password)){return 2}else if(new RegExp(this.password_security_level.lowRegex,"g").test(password)){return 1}else{return 0}},json:function(jsonString){try{JSON.parse(jsonString);return true}catch(e){return false}}};(function($){if(!$.acooly){$.extend({acooly:{}})}$.extend($.acooly,{verify:acooly_verify})})(jQuery);